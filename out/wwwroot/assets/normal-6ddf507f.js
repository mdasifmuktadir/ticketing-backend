import{_,f as y,r as m,o as h,c as u,b as n,a as e,t as a,j as v,F as x,g,d as k}from"./index-e5788531.js";const C={data(){return{approval:0,assigned:0,my:0,myCloseRequests:[],closeRequestsForMe:[],info:[],reject:[],infoMe:[],tickets:[],filteredTickets:[]}},created(){this.$toast.info("Loading Data....");var s=this,o=this.authStore.getToken,t=this.authStore.getUser,d=new FormData;d.append("token",o),d.append("user",JSON.stringify(t)),y.post(s.globalUrl+"getTickets",d).then(i=>{s.tickets=i.data.filter(r=>r.raisedBy.mailAddress==t.mailAddress),s.filteredTickets=s.tickets,s.mainStore.setTickets(s.tickets),s.mainStore.setFilteredTickets(s.tickets),s.approval=s.tickets.filter(r=>r.currentHandler&&r.currentHandler.mailAddress==t.mailAddress&&(r.supervisor&&r.supervisor.mailAddress==r.currentHandler.mailAddress||r.higherApprover&&r.higherApprover.mailAddress==r.currentHandler.mailAddress)),s.closeRequestsForMe=s.tickets.filter(r=>r.currentHandler&&r.currentHandler&&r.currentHandler.mailAddress==t.mailAddress&&r.madeCloseRequest==!0),s.my=s.tickets.filter(r=>r.raisedBy.mailAddress==t.mailAddress),s.infoMe=s.tickets.filter(r=>r.currentHandler&&r.ask==!0&&r.currentHandler.mailAddress==t.mailAddress),s.reject=s.tickets.filter(r=>!r.currentHandler&&r.raisedBy.mailAddress==t.mailAddress&&r.beenRejected==!0),s.$toast.clear(),s.$toast.success("Data Loaded Successfully")}).catch(i=>{s.$toast.clear(),console.log("this is the error"),s.$toast.warning(i)})},methods:{filter(s,o){var t=this;switch(o){case"my":t.mainStore.setFilteredTickets(t.my),t.mainStore.setInitialTickets(t.my);break;case"close":t.mainStore.setFilteredTickets(t.closeRequestsForMe),t.mainStore.setInitialTickets(t.closeRequestsForMe);break;case"info":t.mainStore.setFilteredTickets(t.infoMe),t.mainStore.setInitialTickets(t.infoMe);break;case"approval":t.mainStore.setFilteredTickets(t.approval),t.mainStore.setInitialTickets(t.approval);break}},showDetails(s){const o="/ticketing/ticketDetails/"+s;this.$router.push(o)},showProblemDetails(s){console.log("entered show problem details");var o=s.target,t=o.getBoundingClientRect();const d=t.top+window.scrollY,i=t.left+window.scrollX;console.log(o.innerText);var r=this.$refs.tooltip,f=r.querySelector("#text");f.innerText=o.innerText,console.log("offset top"),console.log(d),r.style.border="2px solid black",r.style.top=d-40+"px",r.style.left=i-40+"px",r.style.display="block"},hideProblemDetails(s){var o=this.$refs.tooltip;o.style.top="px",o.style.left="100px",o.style.display="none"}}},D={class:"fixed w-[300px] h-[200px] overflow-y-scroll p-3 flex-col bg-yellow-100",id:"tooltip",ref:"tooltip",style:{display:"none","z-index":"99999999"}},T={class:"flex flex-col justify-center",style:{"border-radius":"200%",width:"20px",height:"20px","background-color":"black",padding:"2px"}},A=e("div",{id:"text",style:{"word-wrap":"break-word","max-width":"100%"}},null,-1),F={class:"flex flex-row text-lg h-full w-full bg-[rgb(248,248,248)]",id:"app"},S={class:"flex flex-col h-screen customborder bg-white w-1/6 py-10"},q={class:"flex flex-row w-full items-center hover:cursor-pointer"},R={class:"w-1/6 hover:cursor-pointer"},H=e("label",{class:"hover:cursor-pointer"},"All Tickets",-1),M={class:"hover:cursor-pointer"},j={class:"flex flex-row w-full items-center hover:cursor-pointer"},B={class:"w-1/6 hover:cursor-pointer"},N=e("label",{class:"hover:cursor-pointer"},"Tickets Requiring My Approval",-1),E={class:"hover:cursor-pointer"},I={class:"flex flex-row hover:cursor-pointer w-full items-center"},P={class:"w-1/6 hover:cursor-pointer"},V=e("label",{class:"hover:cursor-pointer"},"Closed Requests For Me",-1),L={class:"hover:cursor-pointer"},O={class:"hover:cursor-pointer flex flex-row w-full items-center"},U={class:"hover:cursor-pointer w-1/6"},z=e("label",{class:"hover:cursor-pointer"},"Information Requested From Me",-1),J={class:"hover:cursor-pointer"},X={class:"h-[100vh] bg-[rgb(248,248,248)] p-10 flex flex-col w-5/6 mx-2"},Y={class:"flex flex-row items-end justify-end mr-10 mt-2 mb-2"},$={class:"relative overflow-x-auto mx-2 shadow-md customerborder w-full max-h-[80vh] overflow-y-scroll"},G={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},K=e("thead",{class:"text-xs text-gray-700 uppercase bg-white dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Ticket No. "),e("th",{scope:"col",class:"px-6 py-3"}," Req. Date "),e("th",{scope:"col",class:"px-6 py-3"}," Status "),e("th",{scope:"col",class:"px-6 py-3"}," problem "),e("th",{scope:"col",class:"px-6 py-3"}," Requester "),e("th",{scope:"col",class:"px-6 py-3"}," Current Handler ")])],-1),Q=["onClick"],W=["onClick"],Z=["onClick"],ee=["onClick"],re=["onClick"];function se(s,o,t,d,i,r){const f=m("FilterDrawer"),c=m("font-awesome-icon"),w=m("FilterButton");return h(),u(x,null,[n(f),e("div",D,[e("div",{class:"flex flex-row items-end w-full justify-end hover:cursor-pointer sticky top-0",onClick:o[0]||(o[0]=(...l)=>r.hideProblemDetails&&r.hideProblemDetails(...l))},[e("div",T,[n(c,{icon:"fa-solid fa-xmark",class:"text-white"})])]),A],512),e("div",F,[e("div",S,[e("div",{onClick:o[1]||(o[1]=l=>r.filter(l,"my")),class:"flex flex-row justify-around items-center w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[e("div",q,[e("div",R,[n(c,{icon:"fa-solid fa-file-export",class:"hover:cursor-pointer"})]),H]),e("label",M,a(i.my.length),1)]),e("div",{onClick:o[2]||(o[2]=l=>r.filter(l,"approval")),class:"flex flex-row justify-around items-center w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[e("div",j,[e("div",B,[n(c,{icon:"fa-solid fa-thumbs-up",class:"hover:cursor-pointer"})]),N]),e("label",E,a(i.approval.length),1)]),e("div",{onClick:o[3]||(o[3]=l=>r.filter(l,"close")),class:"flex flex-row justify-around w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[e("div",I,[e("div",P,[n(c,{icon:"fa-solid fa-file-import",class:"hover:cursor-pointer"})]),V]),e("label",L,a(i.closeRequestsForMe.length),1)]),e("div",{onClick:o[4]||(o[4]=l=>r.filter(l,"info")),class:"hover:cursor-pointer flex flex-row justify-around w-full p-5 hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[e("div",O,[e("div",U,[n(c,{icon:" hover:cursor-pointer fa-solid fa-info"})]),z]),e("label",J,a(i.infoMe.length),1)])]),e("div",X,[e("div",Y,[e("div",{onClick:o[5]||(o[5]=(...l)=>this.downloadExcel&&this.downloadExcel(...l)),class:"p-2 bg-white hover:cursor-pointer border border-solid border-gray-400 rounded-sm mt-2 mb-2 mr-2"},[n(c,{icon:"fa-solid fa-table",class:"mr-2"}),v("Download As Excel")]),v(),n(w)]),e("div",$,[e("table",G,[K,e("tbody",null,[(h(!0),u(x,null,g(this.mainStore.getFilteredTickets,(l,b)=>(h(),u("tr",{class:"hover:cursor-pointer bg-white border-b dark:bg-gray-800 dark:border-gray-700",key:b},[e("th",{onClick:p=>r.showDetails(l._id),scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},a(l._id),9,Q),e("td",{onClick:p=>r.showDetails(l._id),class:"px-6 py-4"},a(l.requestDate),9,W),e("td",{onClick:p=>r.showDetails(l._id),class:"px-6 py-4"},a(l.status),9,Z),e("td",{onClick:o[6]||(o[6]=p=>r.showProblemDetails(p)),class:"table-row2 py-3 text-center text-sm overflow-hidden text-ellipsis cursor-pointer whitespace-nowrap max-w-0 text-red-400"},a(l.problemDetails),1),e("td",{onClick:p=>r.showDetails(l._id),class:"px-6 py-4"},a(l.raisedBy.empName),9,ee),e("td",{onClick:p=>r.showDetails(l._id),class:"px-6 py-4"},[l.currentHandler?(h(),u(x,{key:0},[v(a(l.currentHandler.empName),1)],64)):k("",!0)],8,re)]))),128))])])])])])],64)}const te=_(C,[["render",se]]);export{te as default};
