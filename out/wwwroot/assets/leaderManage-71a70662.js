import{_ as k,f as y,X as x,Y as T,r as b,o as v,c as f,b as c,a as s,t as n,j as m,F as w,g as C,d as A,O as D,P as H}from"./index-e5788531.js";const S={data(){return{approval:0,assigned:0,my:0,myCloseRequests:[],closeRequestsForMe:[],info:[],reject:[],infoMe:[],tickets:[],unassigned:[],accepted:[],filteredTickets:[]}},created(){this.$toast.info("Loading Data....");var r=this,t=this.authStore.getToken,o=this.authStore.getUser,i=new FormData;i.append("token",t),i.append("user",JSON.stringify(o)),y.post(r.globalUrl+"getTickets",i).then(a=>{r.tickets=a.data.filter(e=>e.status!="Closed Ticket"),r.mainStore.setFilteredTickets(r.tickets),r.mainStore.setTickets(r.tickets),r.unassigned=r.tickets.filter(e=>e.assigned==!1&&e.ticketingHead&&e.ticketingHead.mailAddress==o.mailAddress&&e.status!="Submitted Ticket - Seeking Supervisor Approval"),r.accepted=r.tickets.filter(e=>e.currentHandler&&e.currentHandler.mailAddress==o.mailAddress&&e.accepted==!0&&e.assigned==!0&&e.assignedTo&&e.assignedTo.mailAddress==o.mailAddress),r.assigned=r.tickets.filter(e=>e.assigned==!0&&e.ticketingHead&&e.ticketingHead.mailAddress==o.mailAddress&&e.currentHandler!=null&&e.accepted==!1),r.approval=r.tickets.filter(e=>e.higherApprover&&e.ticketingHead&&e.currentHandler&&e.ticketingHead.mailAddress==o.mailAddress&&e.currentHandler.mailAddress==e.higherApprover.mailAddress),r.myCloseRequests=r.tickets.filter(e=>e.madeCloseRequest==!0&&e.prevHandler&&e.prevHandler.mailAddress==o.mailAddress),r.info=r.tickets.filter(e=>e.ask==!0&&e.ticketingHead&&e.ticketingHead.mailAddress==o.mailAddress&&e.prevHandler&&e.prevHandler.mailAddress==o.mailAddress),r.$toast.clear(),r.$toast.success("Data Loaded Successfully")}).catch(a=>{r.$toast.clear(),console.log("this is the error"),r.$toast.warning(a)})},methods:{filter(r,t){var o=this,i=o.mainStore;switch(t){case"unassigned":i.setInitialTickets(o.unassigned),i.setFilteredTickets(o.unassigned);break;case"assigned":i.setInitialTickets(o.assigned),i.setFilteredTickets(o.assigned);break;case"accepted":i.setInitialTickets(o.accepted),i.setFilteredTickets(o.accepted);break;case"approval":i.setInitialTickets(o.approval),i.setFilteredTickets(o.approval);break;case"info":i.setInitialTickets(o.info),i.setFilteredTickets(o.info);break;case"close":i.setInitialTickets(o.myCloseRequests),i.setFilteredTickets(o.myCloseRequests);break;case"all":i.setInitialTickets(o.tickets),i.setFilteredTickets(o.tickets);break}},showDetails(r){const t="/ticketing/ticketDetails/"+r;this.$router.push(t)},showProblemDetails(r){console.log("entered show problem details");var t=r.target,o=t.getBoundingClientRect();const i=o.top+window.scrollY,a=o.left+window.scrollX;console.log(t.innerText);var e=this.$refs.tooltip,p=e.querySelector("#text");p.innerText=t.innerText,console.log("offset top"),console.log(i),e.style.border="2px solid black",e.style.top=i-40+"px",e.style.left=a-40+"px",e.style.display="block"},hideProblemDetails(r){var t=this.$refs.tooltip;t.style.top="px",t.style.left="100px",t.style.display="none"},downloadExcel(){var r=this.mainStore.getFilteredTickets;const t=this.convertToExcelData(r),o=x.book_new(),i=x.aoa_to_sheet(t);x.book_append_sheet(o,i,"Sheet1");const a=T(o,{bookType:"xlsx",type:"array"}),e=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=window.URL.createObjectURL(e),d=document.createElement("a");d.href=p,d.setAttribute("download","data.xlsx"),document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(p)},convertToExcelData(r){const t=Object.keys(r[0]),o=r.map(i=>Object.values(i));return[t,...o]}}},h=r=>(D("data-v-05e9e3ae"),r=r(),H(),r),F={class:"fixed w-[300px] h-[200px] overflow-y-scroll p-3 flex-col bg-yellow-100",id:"tooltip",ref:"tooltip",style:{display:"none"}},j={class:"flex flex-col justify-center",style:{"border-radius":"200%",width:"20px",height:"20px","background-color":"black",padding:"2px"}},R=h(()=>s("div",{id:"text",style:{"word-wrap":"break-word","max-width":"100%"}},null,-1)),q={class:"flex flex-row text-lg h-full w-full bg-[rgb(248,248,248)]",id:"app"},I={class:"flex flex-col h-screen customborder bg-white w-1/6 py-10"},B={class:"flex flex-row w-full items-center hover:cursor-pointer"},E={class:"w-1/6 hover:cursor-pointer"},N=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"All Tickets",-1)),O={class:"hover:cursor-pointer text-sm"},U={class:"flex flex-row w-full items-center hover:cursor-pointer"},L={class:"w-1/6 hover:cursor-pointer"},M=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"Unassigned Tickets",-1)),P={class:"hover:cursor-pointer text-sm"},V={class:"flex flex-row hover:cursor-pointer w-full items-center"},X={class:"w-1/6 hover:cursor-pointer"},Y=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"Assigned Tickets",-1)),J={class:"hover:cursor-pointer text-sm"},z={class:"hover:cursor-pointer flex flex-row w-full items-center"},G={class:"hover:cursor-pointer w-1/6 text-sm"},K=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"Accepted Tickets",-1)),Q={class:"hover:cursor-pointer text-sm"},W={class:"flex flex-row w-full items-center hover:cursor-pointer"},Z={class:"w-1/6 hover:cursor-pointer"},$=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"Tickets Awaiting Higher Approval",-1)),ee={class:"hover:cursor-pointer text-sm"},se={class:"flex flex-row w-full items-center hover:cursor-pointer"},re={class:"w-1/6 hover:cursor-pointer"},te=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"My Close Requests",-1)),oe={class:"hover:cursor-pointer text-sm"},le={class:"flex flex-row w-full items-center hover:cursor-pointer"},ie={class:"w-1/6 hover:cursor-pointer"},ae=h(()=>s("label",{class:"hover:cursor-pointer text-sm"},"Information Requested By Me",-1)),de={class:"hover:cursor-pointer text-sm"},ne={class:"h-[100vh] p-5 bg-[rgb(248,248,248)] flex flex-col w-5/6 mx-2"},ce={class:"flex flex-row items-end justify-end"},he={class:"overflow-x-auto mx-2 customerborder w-full overflow-y-scroll",style:{"max-height":"80vh","min-height":"auto"}},pe={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},ue=h(()=>s("thead",{class:"text-xs text-gray-700 uppercase bg-white dark:bg-gray-700 dark:text-gray-400"},[s("tr",null,[s("th",{scope:"col",class:"table-header2 px-6 py-3"}," Ticket No. "),s("th",{scope:"col",class:"table-header2 px-6 py-3"}," Req. Date "),s("th",{scope:"col",class:"table-header2 px-6 py-3"}," Status "),s("th",{scope:"col",class:"table-header2 px-6 py-3"}," problem "),s("th",{scope:"col",class:"table-header2 px-6 py-3"}," Requester "),s("th",{scope:"col",class:"table-header2 px-6 py-3"}," Current Handler ")])],-1)),ve=["onClick"],fe=["onClick"],xe=["onClick"],be=["onClick"],me=["onClick"];function we(r,t,o,i,a,e){const p=b("FilterDrawer"),d=b("font-awesome-icon"),_=b("FilterButton");return v(),f(w,null,[c(p),s("div",F,[s("div",{class:"flex flex-row items-end w-full justify-end hover:cursor-pointer sticky top-0",onClick:t[0]||(t[0]=(...l)=>e.hideProblemDetails&&e.hideProblemDetails(...l))},[s("div",j,[c(d,{icon:"fa-solid fa-xmark",class:"text-white"})])]),R],512),s("div",q,[s("div",I,[s("div",{onClick:t[1]||(t[1]=l=>e.filter(l,"all")),class:"flex flex-row justify-around items-center w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",B,[s("div",E,[c(d,{icon:"fa-solid fa-border-all",class:"hover:cursor-pointer"})]),N]),s("label",O,n(a.tickets.length),1)]),s("div",{onClick:t[2]||(t[2]=l=>e.filter(l,"unassigned")),class:"flex flex-row justify-around items-center w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",U,[s("div",L,[c(d,{icon:"fa-solid fa-tasks",class:"hover:cursor-pointer"})]),M]),s("label",P,n(a.unassigned.length),1)]),s("div",{onClick:t[3]||(t[3]=l=>e.filter(l,"assigned")),class:"flex flex-row justify-around w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",V,[s("div",X,[c(d,{icon:"fa-solid fa-thumbtack hover:cursor-pointer "})]),Y]),s("label",J,n(a.assigned.length),1)]),s("div",{onClick:t[4]||(t[4]=l=>e.filter(l,"accepted")),class:"hover:cursor-pointer flex flex-row justify-around w-full p-5 hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",z,[s("div",G,[c(d,{icon:" hover:cursor-pointer fa-solid fa-check"})]),K]),s("label",Q,n(a.accepted.length),1)]),s("div",{onClick:t[5]||(t[5]=l=>e.filter(l,"approval")),class:"flex flex-row justify-around w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",W,[s("div",Z,[c(d,{icon:"fa-solid fa-thumbtack",class:"hover:cursor-pointer"})]),$]),s("label",ee,n(a.approval.length),1)]),s("div",{onClick:t[6]||(t[6]=l=>e.filter(l,"close")),class:"flex flex-row justify-around w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",se,[s("div",re,[c(d,{icon:"fa-solid fa-file-export",class:"hover:cursor-pointer"})]),te]),s("label",oe,n(a.myCloseRequests.length),1)]),s("div",{onClick:t[7]||(t[7]=l=>e.filter(l,"info")),class:"flex flex-row justify-around w-full p-5 hover:cursor-pointer hover:bg-[rgb(237,237,237)] hover:border-r-4 hover:border-solid hover:border-r-emerald-500"},[s("div",le,[s("div",ie,[c(d,{icon:"fa-solid fa-question",class:"hover:cursor-pointer"})]),ae]),s("label",de,n(a.infoMe.length),1)])]),s("div",ne,[s("div",ce,[s("div",{onClick:t[8]||(t[8]=(...l)=>e.downloadExcel&&e.downloadExcel(...l)),class:"p-2 bg-white hover:cursor-pointer border border-solid border-gray-400 rounded-sm mt-2 mb-2 mr-2"},[c(d,{icon:"fa-solid fa-table",class:"mr-2"}),m("Download As Excel")]),m(),c(_)]),s("div",he,[s("table",pe,[ue,s("tbody",null,[(v(!0),f(w,null,C(this.mainStore.getFilteredTickets,(l,g)=>(v(),f("tr",{class:"hover:cursor-pointer bg-white border-b dark:bg-gray-800 dark:border-gray-700",key:g},[s("th",{onClick:u=>e.showDetails(l._id),scope:"row",class:"table-row2 px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},n(l._id),9,ve),s("td",{onClick:u=>e.showDetails(l._id),class:"table-row2 px-6 py-4"},n(l.requestDate),9,fe),s("td",{onClick:u=>e.showDetails(l._id),class:"table-row2 px-6 py-4"},n(l.status),9,xe),s("td",{onClick:t[9]||(t[9]=u=>e.showProblemDetails(u)),class:"table-row2 py-3 text-center text-sm overflow-hidden text-ellipsis cursor-pointer whitespace-nowrap max-w-0 text-red-400"},n(l.problemDetails),1),s("td",{onClick:u=>e.showDetails(l._id),class:"table-row2 px-6 py-4"},n(l.raisedBy.empName),9,be),s("td",{onClick:u=>e.showDetails(l._id),class:"table-row2 px-6 py-4"},[l.currentHandler?(v(),f(w,{key:0},[m(n(l.currentHandler.empName),1)],64)):A("",!0)],8,me)]))),128))])])])])])],64)}const ge=k(S,[["render",we],["__scopeId","data-v-05e9e3ae"]]);export{ge as default};
